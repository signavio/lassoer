test_that("it returns proper format when provided with timestamp in dmy", {
  expect_equal(as.col_spec('timestamp("02-01-2006 03:04:05PM")')$format, "%d-%m-%Y %I:%M:%OS%p")
  expect_equal(as.col_spec('timestamp("02/01/06T15:04:05.000")')$format, "%d/%m/%yT%H:%M:%OS")
  expect_equal(as.col_spec('timestamp("020106030405PM")')$format, "%d%m%y%I%M%OS%p")
  expect_equal(as.col_spec('timestamp("02012006150405")')$format, "%d%m%Y%H%M%OS")
  expect_equal(as.col_spec('timestamp("02-Jan-2006 15:04:05.000000")')$format, "%d-%b-%Y %H:%M:%OS")
  expect_equal(as.col_spec('timestamp("02 jan 2006 3:04:05.000PM")')$format, "%d %b %Y %I:%M:%OS%p")
  expect_equal(as.col_spec('timestamp("02. January,2006T03:04:05.000000PM")')$format, "%d. %B,%YT%I:%M:%OS%p")
})
test_that("it returns proper format when provided with date in dmy", {
  expect_equal(as.col_spec('date("02.01.2006")')$format, "%d.%m.%Y")
  expect_equal(as.col_spec('date("02\'01\'06")')$format, "%d'%m'%y")
  expect_equal(as.col_spec('date("02-Jan 2006")')$format, "%d-%b %Y")
  expect_equal(as.col_spec('date("02 jan 2006")')$format, "%d %b %Y")
  expect_equal(as.col_spec('date("02- January.2006")')$format, "%d- %B.%Y")
})
test_that("it returns proper format when provided with time", {
  expect_equal(as.col_spec("time('15:04:05')")$format, "%H:%M:%OS")
  expect_equal(as.col_spec('time("15:04:05.000")')$format, "%H:%M:%OS")
  expect_equal(as.col_spec('time("03:04:05PM")')$format, "%I:%M:%OS%p")
  expect_equal(as.col_spec('time("3:04:05PM")')$format, "%I:%M:%OS%p")
  expect_equal(as.col_spec('time("3:04:05.000000PM")')$format, "%I:%M:%OS%p")
})
test_that("it returns error when provided with incorrect date format", {
  expect_error(as.col_spec('date("02-03-2006")')$format, "Unable to determine year/month/day order")
  expect_error(as.col_spec('date("04-01-2006")')$format, "Unable to determine year/month/day order")
  expect_error(as.col_spec('date("06-04-2009")')$format, "Format string contains malformed year, month or day")
})
test_that("it returns error when provided with incorrect timestamp format", {
  expect_error(as.col_spec('timestamp("02-01-2006T15:04:06")')$format, "Format string contains malformed minutes and/or seconds")
  expect_error(as.col_spec('timestamp("02-01-2006T15:07:05")')$format, "Format string contains malformed minutes and/or seconds")
  expect_error(as.col_spec('timestamp("02-01-2006 03:04:05")')$format, "Format string is missing AM/PM indicator")
  expect_error(as.col_spec('timestamp("02-01-2006_15:04:05.000000000")')$format, "Format string contains malformed minutes and/or seconds")
  expect_error(as.col_spec('timestamp("02-01-2009_15:04:05.000")')$format, "Format string contains malformed year, month or day")
})
