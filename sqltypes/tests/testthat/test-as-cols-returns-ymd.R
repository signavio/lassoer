test_that("it returns proper format when provided with timestamp in ymd", {
  expect_equal(as.col_spec('timestamp("2006-01-02 03:04:05PM")')$format, "%Y-%m-%d %I:%M:%OS%p")
  expect_equal(as.col_spec('timestamp("20060102030405PM")')$format, "%Y%m%d%I%M%OS%p")
  expect_equal(as.col_spec('timestamp("060102150405")')$format, "%y%m%d%H%M%OS")
  expect_equal(as.col_spec('timestamp("06/01/02T15:04:05.000")')$format, "%y/%m/%dT%H:%M:%OS")
  expect_equal(as.col_spec('timestamp("2006-Jan-02 15:04:05.000000")')$format, "%Y-%b-%d %H:%M:%OS")
  expect_equal(as.col_spec('timestamp("2006 jan 02 3:04:05.000PM")')$format, "%Y %b %d %I:%M:%OS%p")
  expect_equal(as.col_spec('timestamp("2006. January,02T03:04:05.000000PM")')$format, "%Y. %B,%dT%I:%M:%OS%p")
})
test_that("it returns proper format when provided with date in ymd", {
  expect_equal(as.col_spec('date("2006.01.02")')$format, "%Y.%m.%d")
  expect_equal(as.col_spec('date("06\'01\'02")')$format, "%y'%m'%d")
  expect_equal(as.col_spec('date("2006-Jan 02")')$format, "%Y-%b %d")
  expect_equal(as.col_spec('date("2006 jan 02")')$format, "%Y %b %d")
  expect_equal(as.col_spec('date("2006- January.02")')$format, "%Y- %B.%d")
})
test_that("it returns proper format when provided with time", {
  expect_equal(as.col_spec('time("15:04:05")')$format, "%H:%M:%OS")
  expect_equal(as.col_spec('time("15:04:05.000")')$format, "%H:%M:%OS")
  expect_equal(as.col_spec('time("03:04:05PM")')$format, "%I:%M:%OS%p")
  expect_equal(as.col_spec("time('3:04:05PM')")$format, "%I:%M:%OS%p")
  expect_equal(as.col_spec('time("3:04:05.000000PM")')$format, "%I:%M:%OS%p")
})
test_that("it returns error when provided with incorrect date format", {
  expect_error(as.col_spec('date("2006-03-02")')$format, "Format string contains malformed year, month or day")
  expect_error(as.col_spec('date("2006-01-04")')$format, "Format string contains malformed year, month or day")
  expect_error(as.col_spec('date("2009-04-06")')$format, "Unable to determine year/month/day order")
})
test_that("it returns error when provided with incorrect timestamp format", {
  expect_error(as.col_spec('timestamp("2006-01-02T15:04:06")')$format, "Format string contains malformed minutes and/or seconds")
  expect_error(as.col_spec('timestamp("2006-01-02T15:07:05")')$format, "Format string contains malformed minutes and/or seconds")
  expect_error(as.col_spec('timestamp("2006-01-02 03:04:05")')$format, "Format string is missing AM/PM indicator")
  expect_error(as.col_spec('timestamp("2006-01-02_15:04:05.000000000")')$format, "Format string contains malformed minutes and/or seconds")
  expect_error(as.col_spec('timestamp("2009-01-02_15:04:05.000")')$format, "Unable to determine year/month/day order")
})
