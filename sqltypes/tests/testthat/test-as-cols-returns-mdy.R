test_that("it returns proper format when provided with timestamp in mdy", {
  expect_equal(as.col_spec('timestamp("01-02-2006 03:04:05PM")')$format, "%m-%d-%Y %I:%M:%OS%p")
  expect_equal(as.col_spec('timestamp("01/02/06T15:04:05.000")')$format, "%m/%d/%yT%H:%M:%OS")
  expect_equal(as.col_spec('timestamp("010206030405PM")')$format, "%m%d%y%I%M%OS%p")
  expect_equal(as.col_spec('timestamp("01022006150405")')$format, "%m%d%Y%H%M%OS")
  expect_equal(as.col_spec('timestamp("Jan-02-2006 15:04:05.000000")')$format, "%b-%d-%Y %H:%M:%OS")
  expect_equal(as.col_spec('timestamp("jan 02 2006 3:04:05.000PM")')$format, "%b %d %Y %I:%M:%OS%p")
  expect_equal(as.col_spec('timestamp("January. 02,2006T03:04:05.000000PM")')$format, "%B. %d,%YT%I:%M:%OS%p")
})
test_that("it returns proper format when provided with date in mdy", {
  expect_equal(as.col_spec('date("01.02.2006")')$format, "%m.%d.%Y")
  expect_equal(as.col_spec('date("01\'02\'06")')$format, "%m'%d'%y")
  expect_equal(as.col_spec('date("Jan-02 2006")')$format, "%b-%d %Y")
  expect_equal(as.col_spec('date("jan 02 2006")')$format, "%b %d %Y")
  expect_equal(as.col_spec('date("January- 02.2006")')$format, "%B- %d.%Y")
})
test_that("it returns proper format when provided with time", {
  expect_equal(as.col_spec('time("15:04:05")')$format, "%H:%M:%OS")
  expect_equal(as.col_spec('time("15:04:05.000")')$format, "%H:%M:%OS")
  expect_equal(as.col_spec("time('03:04:05PM')")$format, "%I:%M:%OS%p")
  expect_equal(as.col_spec('time("3:04:05PM")')$format, "%I:%M:%OS%p")
  expect_equal(as.col_spec('time("3:04:05.000000PM")')$format, "%I:%M:%OS%p")
})
test_that("it returns error when provided with incorrect date format", {
  expect_error(as.col_spec('date("01-03-2006")')$format, "Unable to determine year/month/day order")
  expect_error(as.col_spec('date("04-02-2006")')$format, "Unable to determine year/month/day order")
  expect_error(as.col_spec('date("06-04-2009")')$format, "Format string contains malformed year, month or day")
})
test_that("it returns error when provided with incorrect timestamp format", {
  expect_error(as.col_spec('timestamp("01-02-2006T15:04:06")')$format, "Format string contains malformed minutes and/or seconds")
  expect_error(as.col_spec('timestamp("01-02-2006T15:07:05")')$format, "Format string contains malformed minutes and/or seconds")
  expect_error(as.col_spec('timestamp("01-02-2006 03:04:05")')$format, "Format string is missing AM/PM indicator")
  expect_error(as.col_spec('timestamp("01-02-2006_15:04:05.000000000")')$format, "Format string contains malformed minutes and/or seconds")
  expect_error(as.col_spec('timestamp("01-02-2009_15:04:05.000")')$format, "Format string contains malformed year, month or day")
})
